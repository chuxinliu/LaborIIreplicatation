-----------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  F:\GitHub\LaborIIreplicatation\Log\Census Analysis.log
  log type:  text
 opened on:  16 Dec 2019, 16:33:50

. 
. ********************************************************************************
. ************** Open Census Data, Creat Population Change Measures **************
. ********************************************************************************
. 
. use "$datadir\working_data\censuspop7010.dta", clear

. rename cz90 czone

. 
. *Creating 1990 CZ population weights for regressions
. foreach x of varlist cz_pop_1564 cz_pop_1534  {
  2. gen weight_`x'_90 = `x' if year == 1990
  3. egen min_weight_`x'_90 = min(weight_`x'_90), by(czone)
  4. drop weight_`x'_90
  5. rename min_weight_`x'_90 weight_`x'_90
  6. }
(2,223 missing values generated)
(2,223 missing values generated)

. 
. *Creating demographic shares
. gen hispanic_share = cz_pop_his/cz_pop

. gen black_share = cz_pop_black/cz_pop

. gen under25_share = cz_pop_under25/cz_pop

. gen amind_share = cz_pop_amind/cz_pop

. gen asian_share = cz_pop_asian/cz_pop

. 
. xtset czone year, delta(10)
       panel variable:  czone (strongly balanced)
        time variable:  year, 1980 to 2010
                delta:  10 units

. *Creating 10-year contemporaneous and lagged changes in each age group
. foreach x of varlist cz_pop_1564 cz_pop_1534 {
  2. replace `x' = ln(`x')
  3. 
. *10 year changes in log population
. gen l10_`x' = l.`x'
  4. gen `x'_10_change = `x' - l10_`x'
  5. drop l10_`x'
  6. 
. *10 year changes in log population, lagged 10 years. 
. *That is, for 2000-2010 this will be the 1990-2000 change in log population
. *For 1990-2000, this will be the 1980-1990 change
. gen l10_`x'_10_change = l.`x'_10_change
  7. }
(2,964 real changes made)
(741 missing values generated)
(741 missing values generated)
(1,482 missing values generated)
(2,964 real changes made)
(741 missing values generated)
(741 missing values generated)
(1,482 missing values generated)

. 
. 
. ********************************************************************************
. *Demographic Controls***********************************************************
. ********************************************************************************
. local demo_controls = "hispanic_share under25_share black_share amind_share asian_share"

. *We fix Census demographic shares in 1990, and allow for the effect to operate post-2000
. *"move 1990 value to 2010 value"
. foreach x of varlist `demo_controls' {
  2. replace `x' = 0 if year != 1990
  3. egen max_`x' = max(`x'), by(czone)
  4. replace `x' = max_`x'
  5. drop max_`x'
  6. replace `x' = 0 if year!= 2010
  7. }
(2,223 real changes made)
(2,223 real changes made)
(2,223 real changes made)
(2,223 real changes made)
(2,223 real changes made)
(2,223 real changes made)
(2,215 real changes made)
(2,211 real changes made)
(2,211 real changes made)
(2,222 real changes made)
(2,220 real changes made)
(2,220 real changes made)
(2,223 real changes made)
(2,223 real changes made)
(2,223 real changes made)

. 
. ********************************************************************************
. *Merge to NTR Gap Measures******************************************************
. ********************************************************************************
. merge m:1 czone using "$datadir\REStat\NTR Gap.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                            72
        from master                        72  (_merge==1)
        from using                          0  (_merge==2)

    matched                             2,892  (_merge==3)
    -----------------------------------------

. keep if _merge == 3
(72 observations deleted)

. drop _merge

. 
. ********************************************************************************
. *Merging to  CZ Controls********************************************************
. *All of the following are fixed at a given point in time, usually 1990**********
. ********************************************************************************
. merge m:1 czone using "$datadir\REStat\1990 CZ Controls.dta"

    Result                           # of obs.
    -----------------------------------------
    not matched                             4
        from master                         4  (_merge==1)
        from using                          0  (_merge==2)

    matched                             2,888  (_merge==3)
    -----------------------------------------

. keep if _merge == 3
(4 observations deleted)

. drop _merge

. 
. *All of the trade measures and controls turn on for 2000-2010 
. foreach x of varlist ntr_gap ntr_kovak cap_labor skill_int fem_lf_share l_sh_popedu_c l_sh_routine33 l_ta
> sk_outsource debt_to_income break_estimate mfg_share neighbor_fx l_sh_popfborn {
  2. replace `x' = 0 if year != 2010
  3. }
(2,163 real changes made)
(2,163 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)
(2,166 real changes made)

. 
. ********************************************************************************
. *Create region-year dummy variables*********************************************
. ********************************************************************************
. *Creating a Census region dummy for New England, which is omitted 
. gen reg_newe = 0

. replace reg_newe = 1 if (reg_midatl + reg_encen + reg_wncen + reg_satl + reg_escen + reg_wscen + reg_moun
> t + reg_pacif) == 0
(64 real changes made)

. 
. tab year, gen(yeardum)

       year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1980 |        722       25.00       25.00
       1990 |        722       25.00       50.00
       2000 |        722       25.00       75.00
       2010 |        722       25.00      100.00
------------+-----------------------------------
      Total |      2,888      100.00

. foreach x of varlist reg_midatl reg_encen reg_wncen reg_satl reg_escen reg_wscen reg_mount reg_pacif {
  2.         forvalues y = 3/4 {
  3.                 gen reg_year_`x'_`y' = `x'*yeardum`y'
  4.                 }
  5.         }

.         
. *Label variables
. lab var ntr_gap "NTR Gap"

. lab var debt_to_income "Debt to Income"

. lab var break_estimate "HPI Break"

. lab var neighbor_fx "Neighbor CZ Effect"

. lab var l_sh_routine33 "Routineness"

. lab var l_task_outsource "Offshorability"

. lab var cap_labor "Capital-Labor Ratio"

. lab var skill_int "Skill Intensity"

. lab var fem_lf_share "Female Labor Force Share"

. lab var l_sh_popedu_c  "College Educated Share"

. lab var under25_share "Under 25 Share "

. lab var hispanic_share "Hispanic Share"

. lab var black_share "Black Share"

. lab var amind_share "American Indian Share"

. lab var asian_share "Asian Share"

. lab var l10_cz_pop_1564_10_change "Lag 15-64 Change"

. lab var l10_cz_pop_1534_10_change "Lag 15-34 Change"

. lab var cz_pop_1564_10_change "Change in Log Population, 15-64"

. lab var cz_pop_1534_10_change "Change in Log Population, 15-34"

. 
. 
. ********************************************************************************
. *Table 1 (a) *******************************************************************
. ********************************************************************************
. eststo clear

. eststo: reg cz_pop_1564_10_change ntr_gap l10_cz_pop_1564_10_change `demo_controls' debt_to_income break_
> estimate  neighbor_fx l_sh_routine33 l_task_outsource cap_labor skill_int fem_lf_share l_sh_popedu_c year
> dum* reg_year_* [aw = weight_cz_pop_1564_90] if year == 2000 | year == 2010, cluster(czone)
(sum of wgt is 323,973,988.53961)
note: yeardum1 omitted because of collinearity
note: yeardum2 omitted because of collinearity
note: yeardum4 omitted because of collinearity

Linear regression                               Number of obs     =      1,322
                                                F(33, 721)        =      78.75
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7107
                                                Root MSE          =      .0475

                                             (Std. Err. adjusted for 722 clusters in czone)
-------------------------------------------------------------------------------------------
                          |               Robust
    cz_pop_1564_10_change |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
--------------------------+----------------------------------------------------------------
                  ntr_gap |  -.1862631   .1350347    -1.38   0.168    -.4513713    .0788452
l10_cz_pop_1564_10_change |   .5186863   .0374181    13.86   0.000     .4452247    .5921478
           hispanic_share |   .0617565   .0509056     1.21   0.225    -.0381844    .1616975
            under25_share |   .4218758   .1247091     3.38   0.001     .1770395    .6667122
              black_share |  -.1564209   .0503386    -3.11   0.002    -.2552487   -.0575931
              amind_share |  -.1133574   .0640956    -1.77   0.077    -.2391938    .0124789
              asian_share |  -.4785689   .1693143    -2.83   0.005    -.8109769   -.1461609
           debt_to_income |   .0177904   .0305807     0.58   0.561    -.0422475    .0778283
           break_estimate |   .1442416   .0618161     2.33   0.020     .0228805    .2656027
              neighbor_fx |   .2538767   .2879178     0.88   0.378    -.3113807    .8191341
           l_sh_routine33 |   .0032393   .0018268     1.77   0.077    -.0003473    .0068258
         l_task_outsource |    .017021   .0136333     1.25   0.212    -.0097447    .0437866
                cap_labor |    .000719   .0139696     0.05   0.959     -.026707     .028145
                skill_int |   .1037621   .0603256     1.72   0.086    -.0146727    .2221969
             fem_lf_share |  -.3923941   .3393175    -1.16   0.248    -1.058562    .2737743
            l_sh_popedu_c |   .0008411   .0010133     0.83   0.407    -.0011483    .0028306
                 yeardum1 |          0  (omitted)
                 yeardum2 |          0  (omitted)
                 yeardum3 |   .1196092   .1925845     0.62   0.535    -.2584841    .4977026
                 yeardum4 |          0  (omitted)
    reg_year_reg_midatl_3 |   .0333164   .0094908     3.51   0.000     .0146836    .0519492
    reg_year_reg_midatl_4 |  -.0017572   .0110557    -0.16   0.874    -.0234624     .019948
     reg_year_reg_encen_3 |   .0771225   .0096284     8.01   0.000     .0582193    .0960256
     reg_year_reg_encen_4 |  -.0440512   .0117234    -3.76   0.000    -.0670673   -.0210352
     reg_year_reg_wncen_3 |   .0951881     .01131     8.42   0.000     .0729836    .1173926
     reg_year_reg_wncen_4 |  -.0254286   .0086862    -2.93   0.004     -.042482   -.0083753
      reg_year_reg_satl_3 |    .077424   .0127271     6.08   0.000     .0524375    .1024105
      reg_year_reg_satl_4 |   .0277396   .0207603     1.34   0.182    -.0130182    .0684975
     reg_year_reg_escen_3 |     .10398   .0089711    11.59   0.000     .0863674    .1215926
     reg_year_reg_escen_4 |  -.0085089   .0186317    -0.46   0.648    -.0450876    .0280699
     reg_year_reg_wscen_3 |   .1108548   .0099735    11.11   0.000     .0912743    .1304354
     reg_year_reg_wscen_4 |  -.0130586   .0189013    -0.69   0.490    -.0501668    .0240497
     reg_year_reg_mount_3 |   .2103816   .0146466    14.36   0.000     .1816264    .2391367
     reg_year_reg_mount_4 |  -.0615869   .0154509    -3.99   0.000    -.0919211   -.0312527
     reg_year_reg_pacif_3 |   .0344613   .0263105     1.31   0.191     -.017193    .0861156
     reg_year_reg_pacif_4 |  -.0124554   .0205105    -0.61   0.544    -.0527228     .027812
                    _cons |  -.1181218   .1908242    -0.62   0.536    -.4927592    .2565156
-------------------------------------------------------------------------------------------
(est1 stored)

. estadd local YFE "Y"

added macro:
                e(YFE) : "Y"

. esttab using "$outdir/Table_E1", replace se starlevels(* .1 ** 0.05 *** 0.01) r2 label ///
>         compress title("Import Competition and 10-year Changes in Log CZ Population (aged 15-64), Census"
> ) html b(3) se(3) varwidth(20) ///
>         keep(ntr_gap `demo_controls' l10_cz_pop_* debt_to_income break_estimate neighbor_fx l_sh_routine3
> 3 l_task_outsource cap_labor skill_int l_sh_popedu_c fem_lf_share) scalars("YFE Region-Year FE")
(note: file F:\GitHub\LaborIIreplicatation\Result/Table_E1.html not found)
(output written to F:\GitHub\LaborIIreplicatation\Result/Table_E1.html)

. eststo clear

. 
end of do-file

. do "C:\Users\cliu\AppData\Local\Temp\STD914_000000.tmp"

. et more off
command et is unrecognized
r(199);

end of do-file

r(199);

. do "C:\Users\cliu\AppData\Local\Temp\STD914_000000.tmp"

. 
. 
. 
. set more off

. cap log close
